<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Munic√≠pios</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
        .tick-green { color: green; }
        .tick-blue { color: blue; }
        .tick-red { color: red; }
        .actions {
            display: none;
        }
        #map {
            height: 500px;
            width: 100%;
            margin-top: 20px;
        }
        .legend {
            background: white;
            padding: 10px;
            line-height: 1.5em;
        }
    </style>
    <script>
        function toggleActions(id, button) {
            var row = document.getElementById(id);
            var expanded = row.style.display === "none";
            row.style.display = expanded ? "table-row" : "none";
            button.setAttribute("aria-expanded", expanded);
        }
        
        function getRandomTick() {
            const ticks = ['‚úÖ', 'üîµ', '‚ùå'];
            return ticks[Math.floor(Math.random() * ticks.length)];
        }

        function getRandomActions() {
            const actions = [
                "Programa de inclus√£o digital",
                "Capacita√ß√£o profissional",
                "Acessibilidade no transporte p√∫blico",
                "Atendimento priorit√°rio em servi√ßos",
                "Incentivo ao esporte adaptado",
                "Cursos de Libras",
                "Reabilita√ß√£o e suporte m√©dico"
            ];
            let numActions = Math.floor(Math.random() * 5) + 3;
            let selectedActions = [];
            for (let i = 0; i < numActions; i++) {
                selectedActions.push({
                    name: actions[Math.floor(Math.random() * actions.length)],
                    status: ["Execu√ß√£o", "A iniciar", "Conclu√≠do"][Math.floor(Math.random() * 3)]
                });
            }
            return selectedActions;
        }
    </script>
</head>
<body>
    <h2>Painel de Munic√≠pios</h2>
    <div id="map" role="application" aria-label="Mapa do Brasil com munic√≠pios destacados"></div>
    <table>
        <thead>
            <tr>
                <th>Munic√≠pio</th>
                <th>A√ß√µes</th>
                <th>Fundo da Pessoa</th>
                <th>Conselho da Pessoa</th>
                <th>Plano Municipal de Direitos</th>
                <th>Autonomia</th>
                <th>Indicador Sint√©tico</th>
            </tr>
        </thead>
        <tbody>
            <script>
                const municipios = [
                    "S√£o Paulo", "Rio de Janeiro", "Belo Horizonte", "Porto Alegre", "Salvador", "Fortaleza", "Curitiba", "Recife", "Goi√¢nia", "Bel√©m",
                    "Manaus", "Vit√≥ria", "Florian√≥polis", "Campo Grande", "Cuiab√°", "Teresina", "Natal", "Jo√£o Pessoa", "Aracaju", "Macei√≥"
                ];
                
                let map = L.map('map').setView([-15.7801, -47.9292], 4);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(map);
                
                municipios.forEach((municipio, index) => {
                    let actions = getRandomActions();
                    let ticks = [getRandomTick(), getRandomTick(), getRandomTick(), getRandomTick()];
                    let indicadorSintetico = ticks.filter(t => t === '‚úÖ').length;
                    
                    document.write(<tr>
                        <td>${municipio}</td>
                        <td><button onclick="toggleActions('actions-${index}', this)" aria-expanded="false" aria-label="Expandir a√ß√µes para ${municipio}">+</button></td>
                        <td class="tick-green">${ticks[0]}</td>
                        <td class="tick-blue">${ticks[1]}</td>
                        <td class="tick-red">${ticks[2]}</td>
                        <td class="tick-green">${ticks[3]}</td>
                        <td>${indicadorSintetico}</td>
                    </tr>);
                    document.write(<tr id="actions-${index}" class="actions">
                        <td colspan="7">
                            <ul>
                                ${actions.map(action => <li>${action.name} - <strong>${action.status}</strong></li>).join('')}
                            </ul>
                        </td>
                    </tr>);

                    let color = indicadorSintetico >= 3 ? 'green' : indicadorSintetico >= 2 ? 'orange' : 'red';
                    
                    L.circleMarker([-15.7801 + (Math.random() * 10 - 5), -47.9292 + (Math.random() * 10 - 5)], {
                        radius: 8,
                        color: color,
                        fillColor: color,
                        fillOpacity: 0.6
                    }).bindPopup(<b>${municipio}</b><br>Indicador: ${indicadorSintetico}).addTo(map);
                });
            </script>
        </tbody>
    </table>
</body>
</html>
